<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weekly Grocery List</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet" />

  <style>
    :root {
      --mediterranean-blue: #1e3a5f;
      --olive-green: #556b2f;
      --terracotta: #c65d3b;
      --feta-white: #f8f6f0;
      --warm-stone: #e6e2d3;
      --deep-sea: #0f2027;
      --accent-gold: #d4a373;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Cormorant Garamond', serif;
      background: linear-gradient(135deg, var(--feta-white), var(--warm-stone));
      color: var(--deep-sea);
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .hero {
      background: linear-gradient(135deg, var(--mediterranean-blue), var(--deep-sea));
      color: var(--feta-white);
      padding: 64px 0 88px;
    }

    h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(2.6rem, 7vw, 4.5rem);
      margin-bottom: 10px;
    }

    .sub { font-size: 1.2rem; opacity: 0.95; }
    .meta { margin-top: 14px; color: var(--accent-gold); font-size: 1.25rem; }

    .view-tabs {
      margin-top: 28px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .tab-btn {
      border: none;
      background: rgba(255,255,255,0.15);
      color: white;
      padding: 10px 18px;
      border-radius: 999px;
      cursor: pointer;
      font-family: inherit;
      font-size: 1rem;
    }

    .tab-btn.active {
      background: var(--terracotta);
      color: #fff;
    }

    .panel {
      margin-top: -34px;
      padding-bottom: 26px;
    }

    .view-panel { display: none; }
    .view-panel.active { display: block; }

    .grocery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 22px;
    }

    .grocery-group {
      background: #fff;
      border-radius: 22px;
      padding: 24px;
    }

    .grocery-group h2 {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      margin-bottom: 14px;
    }

    .grocery-list { list-style: none; }

    .grocery-item label {
      display: grid;
      grid-template-columns: 22px 74px 72px 1fr;
      gap: 8px;
      align-items: center;
      padding: 6px 0;
      cursor: pointer;
    }

    .grocery-item input {
      width: 18px;
      height: 18px;
    }

    .grocery-qty { text-align: right; }
    .grocery-unit { color: #5f6670; }
    .grocery-name { font-weight: 600; }

    .recipes-shell {
      background: #fff;
      border-radius: 22px;
      padding: 22px;
    }

    .meal-tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .meal-btn {
      border: none;
      background: #edf1f7;
      color: var(--mediterranean-blue);
      padding: 8px 14px;
      border-radius: 999px;
      cursor: pointer;
      font-family: inherit;
      font-size: 1rem;
    }

    .meal-btn.active {
      background: var(--mediterranean-blue);
      color: #fff;
    }

    .recipes-grid {
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 18px;
    }

    .recipe-list-panel,
    .recipe-detail-panel {
      background: var(--feta-white);
      border-radius: 16px;
      padding: 16px;
    }

    .recipe-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 72vh;
      overflow: auto;
    }

    .recipe-row-btn {
      width: 100%;
      text-align: left;
      border: 1px solid #d8dbe2;
      background: #fff;
      border-radius: 12px;
      padding: 10px 12px;
      cursor: pointer;
      font-family: inherit;
    }

    .recipe-row-btn.active {
      border-color: var(--terracotta);
      background: #fff7f3;
    }

    .recipe-row-title {
      font-weight: 700;
      margin-bottom: 4px;
    }

    .recipe-row-meta {
      font-size: 0.95rem;
      color: #596171;
    }

    .recipe-title {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.7rem, 4vw, 2.3rem);
      margin-bottom: 8px;
    }

    .recipe-meta {
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
      margin-bottom: 16px;
      color: #2c3645;
    }

    .chip {
      background: #fff;
      border: 1px solid #d8dbe2;
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 0.95rem;
    }

    .detail-grid {
      display: grid;
      grid-template-columns: 1fr 1.2fr;
      gap: 16px;
    }

    .detail-card {
      background: #fff;
      border-radius: 12px;
      padding: 14px;
    }

    .detail-card h4 {
      font-family: 'Playfair Display', serif;
      margin-bottom: 10px;
    }

    .detail-list {
      list-style: none;
    }

    .detail-list li {
      display: flex;
      gap: 10px;
      padding: 5px 0;
      align-items: flex-start;
    }

    .detail-list input {
      width: 18px;
      height: 18px;
      margin-top: 2px;
    }

    .recipe-link {
      margin-top: 12px;
      display: inline-block;
      background: var(--terracotta);
      color: #fff;
      text-decoration: none;
      padding: 9px 14px;
      border-radius: 999px;
    }

    .empty-state {
      color: #5d6675;
      background: #fff;
      border: 1px dashed #c8ced9;
      border-radius: 12px;
      padding: 14px;
    }

    .site-footer {
      text-align: center;
      color: #556;
      padding: 24px 0 30px;
    }

    @media (max-width: 980px) {
      .hero {
        padding: 48px 0 56px;
      }

      .panel {
        margin-top: -18px;
      }

      .recipes-grid {
        grid-template-columns: 1fr;
      }

      .detail-grid {
        grid-template-columns: 1fr;
      }

      .recipe-list {
        max-height: 300px;
      }
    }

    @media (max-width: 640px) {
      .container {
        width: min(100% - 22px, 1200px);
      }

      .grocery-item label {
        grid-template-columns: 20px 60px 64px 1fr;
      }

      .grocery-group h2 {
        font-size: 1.7rem;
      }
    }
  </style>
</head>
<body>

  <section class="hero">
    <div class="container">
      <h1>Weekly Grocery List</h1>
      <div class="sub">{{WEEK_RANGE}}</div>
      <div class="meta">Total items: {{TOTAL_ITEMS}}</div>

      <div class="view-tabs">
        <button id="tab-grocery" class="tab-btn active" onclick="setView('grocery')">Grocery List</button>
        <button id="tab-recipes" class="tab-btn" onclick="setView('recipes')">Weekly Recipes</button>
      </div>
    </div>
  </section>

  <div class="container panel">
    <section id="view-grocery" class="view-panel active">
      <div class="grocery-grid">
        {{GROCERY_GROUPS}}
      </div>
    </section>

    <section id="view-recipes" class="view-panel">
      <div class="recipes-shell">
        <div class="meal-tabs">
          <button id="meal-breakfast" class="meal-btn active" onclick="setMeal('Breakfast')">Breakfast</button>
          <button id="meal-lunch" class="meal-btn" onclick="setMeal('Lunch')">Lunch</button>
          <button id="meal-dinner" class="meal-btn" onclick="setMeal('Dinner')">Dinner</button>
        </div>

        <div class="recipes-grid">
          <aside class="recipe-list-panel">
            <div id="recipe-list" class="recipe-list"></div>
          </aside>

          <main class="recipe-detail-panel">
            <div id="recipe-detail"></div>
          </main>
        </div>
      </div>
    </section>
  </div>

  <footer class="site-footer">
    <div>All rights reserved. 1Four1. 2026</div>
    <div>Made with love by Papi ❤️</div>
  </footer>

  <script>
    const WEEK_RECIPES = {{RECIPES_JSON}};
    let activeView = "grocery";
    let activeMeal = "Breakfast";
    let activeIndex = 0;

    function esc(s) {
      return String(s ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;");
    }

    function setView(view) {
      activeView = view;
      document.getElementById("tab-grocery").classList.toggle("active", view === "grocery");
      document.getElementById("tab-recipes").classList.toggle("active", view === "recipes");
      document.getElementById("view-grocery").classList.toggle("active", view === "grocery");
      document.getElementById("view-recipes").classList.toggle("active", view === "recipes");
    }

    function setMeal(meal) {
      activeMeal = meal;
      activeIndex = 0;
      document.getElementById("meal-breakfast").classList.toggle("active", meal === "Breakfast");
      document.getElementById("meal-lunch").classList.toggle("active", meal === "Lunch");
      document.getElementById("meal-dinner").classList.toggle("active", meal === "Dinner");
      renderRecipeList();
      renderRecipeDetail();
    }

    function getMealData() {
      return WEEK_RECIPES?.[activeMeal] || [];
    }

    function renderRecipeList() {
      const listEl = document.getElementById("recipe-list");
      const rows = getMealData();

      if (!rows.length) {
        listEl.innerHTML = `
          <div class="empty-state">
            No recipes found for ${esc(activeMeal)}.
            <br /><br />
            Make sure your row objects include title/ingredients/steps columns, not only grocery column 17.
          </div>
        `;
        return;
      }

      listEl.innerHTML = rows.map((r, i) => `
        <button class="recipe-row-btn ${i === activeIndex ? "active" : ""}" onclick="pickRecipe(${i})">
          <div class="recipe-row-title">${esc(r.title || "Untitled Recipe")}</div>
          <div class="recipe-row-meta">${esc(r.cuisine || "")} ${r.time ? "• " + esc(r.time) + " min" : ""}</div>
        </button>
      `).join("");
    }

    function pickRecipe(i) {
      activeIndex = i;
      renderRecipeList();
      renderRecipeDetail();
    }

    function renderRecipeDetail() {
      const detailEl = document.getElementById("recipe-detail");
      const rows = getMealData();

      if (!rows.length) {
        detailEl.innerHTML = `<div class="empty-state">No recipe selected.</div>`;
        return;
      }

      const r = rows[activeIndex] || rows[0];
      const ingredients = Array.isArray(r.ingredients) ? r.ingredients : [];
      const steps = Array.isArray(r.steps) ? r.steps : [];
      const tips = Array.isArray(r.tips) ? r.tips : [];

      detailEl.innerHTML = `
        <h3 class="recipe-title">${esc(r.title || "Untitled Recipe")}</h3>
        <div class="recipe-meta">
          <span class="chip">${esc(r.cuisine || "Cuisine")}</span>
          <span class="chip">${esc(r.servings || "-")} servings</span>
          <span class="chip">${esc(r.time || "-")} min</span>
          <span class="chip">${esc(r.calories || "-")} cal</span>
        </div>

        <div class="detail-grid">
          <section class="detail-card">
            <h4>Ingredients</h4>
            <ul class="detail-list">
              ${ingredients.length
                ? ingredients.map(it => `<li><input type="checkbox"><span>${esc(it)}</span></li>`).join("")
                : `<li><span>No ingredients provided.</span></li>`}
            </ul>
          </section>

          <section class="detail-card">
            <h4>Preparation</h4>
            <ul class="detail-list">
              ${steps.length
                ? steps.map((s, idx) => `<li><input type="checkbox"><span><strong>Step ${idx + 1}:</strong> ${esc(s)}</span></li>`).join("")
                : `<li><span>No steps provided.</span></li>`}
            </ul>
          </section>
        </div>

        ${tips.length ? `
          <section class="detail-card" style="margin-top:12px;">
            <h4>Chef's Secrets</h4>
            <ul class="detail-list">
              ${tips.map(t => `<li><span>${esc(t)}</span></li>`).join("")}
            </ul>
          </section>
        ` : ""}

        ${r.link ? `<a class="recipe-link" href="${esc(r.link)}" target="_blank" rel="noopener noreferrer">Open Full Recipe</a>` : ""}
      `;
    }

    function initRecipes() {
      renderRecipeList();
      renderRecipeDetail();
    }

    initRecipes();
  </script>
</body>
</html>
